# Excel批量导入分类功能使用指南

## 功能概述

Excel批量导入分类功能允许管理员通过上传Excel文件来批量创建分类，支持层级分类结构的创建。

## 使用步骤

### 1. 下载模板文件

在分类管理页面点击"批量导入"按钮，在弹出的对话框中可以下载模板文件：
- **Excel模板**：下载.xls格式的模板文件
- **CSV模板**：下载.csv格式的模板文件

### 2. 填写分类数据

模板文件包含以下列：

| 列名 | 是否必填 | 说明 |
|------|----------|------|
| 分类名称 | 是 | 分类的名称，长度2-50个字符 |
| 描述 | 否 | 分类的详细描述 |
| 父分类名称 | 否 | 如果是子分类，填写父分类的名称 |
| 排序 | 否 | 数字，用于同级分类的排序，默认为0 |

### 3. 注意事项

- **保持表头不变**：第一行的表头必须保持不变
- **删除示例数据**：模板中的示例数据需要删除，填入实际的分类数据
- **层级关系**：父分类必须在子分类之前创建
- **文件格式**：支持.xlsx和.xls格式
- **文件大小**：不超过5MB
- **分类名称唯一性**：分类名称不能重复

### 4. 上传文件

1. 在分类管理页面点击"批量导入"按钮
2. 选择填写好的Excel文件
3. 点击"开始导入"按钮
4. 等待导入完成，查看导入结果

## 示例数据

```
分类名称    | 描述           | 父分类名称 | 排序
文学        | 文学类资源     |           | 1
小说        | 小说类文学作品 | 文学      | 1
诗歌        | 诗歌类文学作品 | 文学      | 2
科技        | 科技类资源     |           | 2
人工智能    | AI相关资源     | 科技      | 1
编程        | 编程相关资源   | 科技      | 2
```

## 导入结果

导入完成后会显示：
- **总行数**：Excel文件中的数据行数
- **成功数量**：成功创建的分类数量
- **失败数量**：创建失败的分类数量
- **成功列表**：成功创建的分类名称列表
- **错误信息**：失败的行号和具体错误原因

## 常见错误

1. **分类名称已存在**：分类名称不能重复
2. **父分类不存在**：父分类名称必须是已存在的分类
3. **分类名称为空**：分类名称是必填项
4. **分类名称过长**：分类名称不能超过50个字符
5. **文件格式错误**：只支持Excel格式文件

## 技术实现

### 后端
- 使用`xlsx`库解析Excel文件
- 支持.xlsx和.xls格式
- 按层级顺序创建分类
- 详细的错误处理和反馈

### 前端
- 文件类型和大小验证
- 实时导入进度显示
- 详细的导入结果展示
- 模板文件下载功能

## API接口

```
POST /api/categories/import
Content-Type: multipart/form-data

参数：
- file: Excel文件

返回：
{
  "message": "导入完成，成功创建 X 个分类，失败 Y 个",
  "data": {
    "success": true,
    "totalRows": 10,
    "successCount": 8,
    "errorCount": 2,
    "errors": [...],
    "createdCategories": [...]
  }
}
```
