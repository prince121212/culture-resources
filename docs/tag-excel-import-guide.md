# Excel批量导入标签功能使用指南

## 功能概述

Excel批量导入标签功能允许管理员通过上传Excel文件来批量创建标签，简化标签管理工作。

## 使用步骤

### 1. 下载模板文件

在标签管理页面点击"批量导入"按钮，在弹出的对话框中可以下载模板文件：
- **Excel模板**：下载.xls格式的模板文件
- **CSV模板**：下载.csv格式的模板文件

### 2. 填写标签数据

模板文件包含以下列：

| 列名 | 是否必填 | 说明 |
|------|----------|------|
| 标签名称 | 是 | 标签的名称，长度1-30个字符 |
| 描述 | 否 | 标签的详细描述，不超过200个字符 |

### 3. 注意事项

- **保持表头不变**：第一行的表头必须保持不变
- **删除示例数据**：模板中的示例数据需要删除，填入实际的标签数据
- **文件格式**：支持.xlsx和.xls格式
- **文件大小**：不超过5MB
- **标签名称唯一性**：标签名称不能重复（不区分大小写）

### 4. 上传文件

1. 在标签管理页面点击"批量导入"按钮
2. 选择填写好的Excel文件
3. 点击"开始导入"按钮
4. 等待导入完成，查看导入结果

## 示例数据

```
标签名称    | 描述
流行        | 流行文化相关内容
古代        | 古代历史文化内容
现代        | 现代文化内容
学术        | 学术研究相关内容
教育        | 教育教学相关内容
娱乐        | 娱乐休闲相关内容
```

## 导入结果

导入完成后会显示：
- **总行数**：Excel文件中的数据行数
- **成功数量**：成功创建的标签数量
- **失败数量**：创建失败的标签数量
- **成功列表**：成功创建的标签名称列表
- **错误信息**：失败的行号和具体错误原因

## 常见错误

1. **标签名称已存在**：标签名称不能重复
2. **标签名称为空**：标签名称是必填项
3. **标签名称过长**：标签名称不能超过30个字符
4. **描述过长**：标签描述不能超过200个字符
5. **文件格式错误**：只支持Excel格式文件

## 技术实现

### 后端
- 使用`xlsx`库解析Excel文件
- 支持.xlsx和.xls格式
- 详细的错误处理和反馈
- 标签名称唯一性检查（不区分大小写）

### 前端
- 文件类型和大小验证
- 实时导入进度显示
- 详细的导入结果展示
- 模板文件下载功能

## API接口

```
POST /api/tags/import
Content-Type: multipart/form-data

参数：
- file: Excel文件

返回：
{
  "message": "导入完成，成功创建 X 个标签，失败 Y 个",
  "data": {
    "success": true,
    "totalRows": 10,
    "successCount": 8,
    "errorCount": 2,
    "errors": [...],
    "createdTags": [...]
  }
}
```

## 与分类导入的区别

| 功能 | 分类导入 | 标签导入 |
|------|----------|----------|
| 层级关系 | 支持父子分类 | 不支持层级 |
| 字段数量 | 4个字段 | 2个字段 |
| 排序功能 | 支持排序字段 | 不支持排序 |
| 复杂度 | 较复杂 | 较简单 |
